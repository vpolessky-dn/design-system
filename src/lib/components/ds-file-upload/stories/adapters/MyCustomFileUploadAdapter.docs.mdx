import { Story, Source, Canvas } from '@storybook/blocks';
import { DsFileUpload } from '../..';
import { MyCustomFileUploadAdapter } from './MyCustomFileUploadAdapter';
import code from './MyCustomFileUploadAdapter.ts?raw';

# File Upload

To use the file upload component you need to add an adapter that implements the `FileUploadAdapter` interface using the native
[`XMLHttpRequest`](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest)
API. See `MyCustomFileUploadAdapter` sample code below.

---

This is a minimal interactive story showing how the adapter can be used. Click on **Show code** to see adapter usage.

<Canvas>
  <Story name="Default">
    {() => {
      const adapter = new MyCustomFileUploadAdapter({
        bucket: 'my-bucket',
        region: 'us-east-1',
        getPresignedUrl: async (fileName) => `https://example-bucket.s3.amazonaws.com/${fileName}?signature=mocked`,
      });

      return (
    			<DsFileUpload
    				adapter={adapter}
    				onFilesAdded={(files) => console.log('ðŸ“ Files added:', files.map((f) => f.name))}
    				onUploadComplete={(fileId, result) => console.log('âœ… Upload complete:', fileId, result.url)}
    				onUploadError={(fileId, error) => console.error('âŒ Upload failed:', fileId, error)}
    				onFileRemoved={(fileId) => console.log('ðŸ—‘ï¸ File removed:', fileId)}
    				onAllUploadsComplete={() => console.log('ðŸŽ‰ All uploads complete!')}
    			/>
      );
    }}

  </Story>
</Canvas>

## MyCustomFileUploadAdapter

<Source code={code} language="ts" dark />
